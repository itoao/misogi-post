import{r as t,h as e,H as i}from"./p-33b9aa6b.js";import{I18n as s,Logger as n,ConsoleLogger as a,isEmpty as r}from"@aws-amplify/core";import{M as o,C as h,A as l,a as u,U as p}from"./p-417bb5ea.js";import{Auth as d}from"@aws-amplify/auth";import{T as c}from"./p-26837fd8.js";import{N as m,g as f,b as y}from"./p-900152ca.js";import{d as b,a as w,c as g,i as C,h as v,b as F,g as x}from"./p-639f5cf6.js";import{c as k,h as _}from"./p-0cebebfa.js";const I=class{constructor(e){t(this,e),this.handleSubmit=t=>this.confirm(t),this.headerText=c.CONFIRM_SMS_CODE,this.submitButtonText=c.CONFIRM,this.handleAuthStateChange=b,this.defaultFormFields=[{type:"code",required:!0,handleInputChange:t=>this.handleCodeChange(t)}],this.formFields=this.defaultFormFields,this.mfaOption=o.SMS,this.loading=!1}componentWillLoad(){this.setup()}userHandler(){this.setup()}setup(){this.user&&this.user.challengeName===h.SoftwareTokenMFA&&(this.mfaOption=o.TOTP,this.headerText===c.CONFIRM_SMS_CODE&&(this.headerText=c.CONFIRM_TOTP_CODE)),this.constructedFormFieldOptions=this.constructFormFieldOptions(this.formFields)}handleCodeChange(t){this.code=t.target.value}async confirm(t){t&&t.preventDefault();const e=this.user.challengeName===h.SoftwareTokenMFA?h.SoftwareTokenMFA:null;if(!d||"function"!=typeof d.confirmSignIn)throw new Error(m);this.loading=!0;try{await d.confirmSignIn(this.user,this.code,e),await k(this.user,this.handleAuthStateChange)}catch(i){w(i)}finally{this.loading=!1}}constructFormFieldOptions(t){const e=[];if(void 0!==t)return t.length<=0?this.defaultFormFields:(t.forEach(t=>{e.push("string"==typeof t||"code"!==t.type?t:Object.assign({handleInputChange:t=>this.handleCodeChange(t)},t))}),e)}render(){return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),handleSubmit:this.handleSubmit,submitButtonText:s.get(this.submitButtonText),loading:this.loading,secondaryFooterContent:e("span",null,e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignIn)},s.get(c.BACK_TO_SIGN_IN)))},e("amplify-auth-fields",{formFields:this.constructedFormFieldOptions})))}static get watchers(){return{user:["userHandler"]}}},P=class{constructor(e){t(this,e),this.handleSubmit=t=>this.confirmSignUp(t),this.headerText=c.CONFIRM_SIGN_UP_HEADER_TEXT,this.submitButtonText=c.CONFIRM_SIGN_UP_SUBMIT_BUTTON_TEXT,this.formFields=[],this.handleAuthStateChange=b,this.usernameAlias="username",this.loading=!1,this.newFormFields=[],this.phoneNumber={countryDialCodeValue:f,phoneNumberValue:null}}componentWillLoad(){this.setup()}formFieldsHandler(){this.buildFormFields()}userHandler(){this.setup()}setup(){this.userInput=this.user&&this.user.username,this._signUpAttrs=this.user&&this.user.signUpAttrs,g(this.usernameAlias),this.buildFormFields()}buildDefaultFormFields(){this.newFormFields=[{type:""+this.usernameAlias,required:!0,handleInputChange:this.handleFormFieldInputChange(""+this.usernameAlias),value:this.userInput,disabled:!!this.userInput,inputProps:{autocomplete:"username"}},{type:"code",label:s.get(c.CONFIRM_SIGN_UP_CODE_LABEL),placeholder:s.get(c.CONFIRM_SIGN_UP_CODE_PLACEHOLDER),required:!0,hint:e("div",null,s.get(c.CONFIRM_SIGN_UP_LOST_CODE)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.resendConfirmCode()},s.get(c.CONFIRM_SIGN_UP_RESEND_CODE))),handleInputChange:this.handleFormFieldInputChange("code")}]}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(i=>{const n=Object.assign({},i);"code"===n.type&&(n.hint=C(n)?e("div",null,s.get(c.CONFIRM_SIGN_UP_LOST_CODE)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.resendConfirmCode()},s.get(c.CONFIRM_SIGN_UP_RESEND_CODE))):n.hint),n.handleInputChange=t=>this.handleFormFieldInputWithCallback(t,i),t.push(n)}),this.newFormFields=t}}handleFormFieldInputChange(t){switch(t){case"username":case"email":return t=>this.userInput=t.target.value;case"phone_number":return t=>v(t,this.phoneNumber);case"code":return t=>this.code=t.target.value;default:return}}setFieldValue(t){switch(t.type){case"username":case"email":this.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(t,e)=>{e(t)})(t,this.handleFormFieldInputChange(e.type).bind(this))}getUsername(){if(this.user&&this.user.username)return this.user.username;switch(this.usernameAlias){case"username":case"email":return this.userInput;case"phone_number":return F(this.phoneNumber)}}async resendConfirmCode(){if(event&&event.preventDefault(),!d||"function"!=typeof d.resendSignUp)throw new Error(m);try{const t=this.getUsername();if(!t)throw new Error(c.EMPTY_USERNAME);await d.resendSignUp(t.trim())}catch(t){w(t)}}async confirmSignUp(t){if(t&&t.preventDefault(),!d||"function"!=typeof d.confirmSignUp)throw new Error(m);this.loading=!0;try{let t=this.getUsername();if(!t)throw new Error(c.EMPTY_USERNAME);if(t=t.trim(),!(await d.confirmSignUp(t,this.code)))throw new Error(s.get(c.CONFIRM_SIGN_UP_FAILED));this._signUpAttrs&&this._signUpAttrs.password&&""!==this._signUpAttrs.password?await _(t,this._signUpAttrs.password,this.handleAuthStateChange):this.handleAuthStateChange(l.SignIn)}catch(e){w(e)}finally{this.loading=!1}}render(){return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),submitButtonText:s.get(this.submitButtonText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:e("div",null,e("span",null,e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignIn)},s.get(c.BACK_TO_SIGN_IN))))},e("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{formFields:["formFieldsHandler"],user:["userHandler"]}}},q=new n("ForgotPassword"),j=class{constructor(e){t(this,e),this.headerText=c.RESET_YOUR_PASSWORD,this.sendButtonText=c.SEND_CODE,this.submitButtonText=c.SUBMIT,this.formFields=[],this.handleSend=t=>this.send(t),this.handleSubmit=t=>this.submit(t),this.handleAuthStateChange=b,this.usernameAlias="username",this.delivery=null,this.loading=!1,this.phoneNumber={countryDialCodeValue:f,phoneNumberValue:null},this.newFormFields=[],this.forgotPasswordAttrs={userInput:"",password:"",code:""}}componentWillLoad(){g(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const i=Object.assign({},e);i.handleInputChange=t=>this.handleFormFieldInputWithCallback(t,e),t.push(i)}),this.newFormFields=t}}buildDefaultFormFields(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"forgot-password-email-input"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"forgot-password-phone-number-input"}}];break;case"username":default:this.newFormFields=[{type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"forgot-password-username-input"}}]}}handleFormFieldInputChange(t){switch(t){case"username":case"email":return t=>this.forgotPasswordAttrs.userInput=t.target.value;case"phone_number":return t=>v(t,this.phoneNumber);case"password":case"code":return e=>this.forgotPasswordAttrs[t]=e.target.value;default:return}}setFieldValue(t,e){switch(t.type){case"username":case"email":e.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;case"password":case"code":e[t.type]=void 0===t.value?"":t.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(t,e)=>{e(t)})(t,this.handleFormFieldInputChange(e.type).bind(this))}async send(t){if(t&&t.preventDefault(),!d||"function"!=typeof d.forgotPassword)throw new Error(m);switch(this.loading=!0,this.usernameAlias){case"phone_number":try{this.forgotPasswordAttrs.userInput=F(this.phoneNumber)}catch(e){w(e)}}try{const t=await d.forgotPassword(this.forgotPasswordAttrs.userInput.trim());q.debug(t),this.newFormFields=[{type:"code",required:!0,handleInputChange:this.handleFormFieldInputChange("code"),inputProps:{"data-test":"forgot-password-code-input"}},{type:"password",required:!0,handleInputChange:this.handleFormFieldInputChange("password"),label:s.get(c.NEW_PASSWORD_LABEL),placeholder:s.get(c.NEW_PASSWORD_PLACEHOLDER)}],this.delivery=t.CodeDeliveryDetails}catch(e){w(e)}finally{this.loading=!1}}async submit(t){if(t&&t.preventDefault(),!d||"function"!=typeof d.forgotPasswordSubmit)throw new Error(m);this.loading=!0;try{const{userInput:t,code:e,password:i}=this.forgotPasswordAttrs,s=await d.forgotPasswordSubmit(t.trim(),e,i);q.debug(s),this.handleAuthStateChange(l.SignIn),this.delivery=null}catch(e){w(e)}finally{this.loading=!1}}render(){const t=this.delivery?t=>this.handleSubmit(t):t=>this.handleSend(t),n=this.delivery?this.submitButtonText:this.sendButtonText;return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),handleSubmit:t,loading:this.loading,secondaryFooterContent:e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignIn),"data-test":"forgot-password-back-to-sign-in-link"},s.get(c.BACK_TO_SIGN_IN)),testDataPrefix:"forgot-password",submitButtonText:s.get(n)},e("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{formFields:["formFieldsHandler"]}}},E=new a("amplify-require-new-password"),T=class{constructor(e){t(this,e),this.headerText=c.CHANGE_PASSWORD,this.submitButtonText=c.CHANGE_PASSWORD_ACTION,this.handleSubmit=t=>this.completeNewPassword(t),this.handleAuthStateChange=b,this.formFields=[{type:u.Password,required:!0,handleInputChange:t=>this.handlePasswordChange(t),label:s.get(c.NEW_PASSWORD_LABEL),placeholder:s.get(c.NEW_PASSWORD_PLACEHOLDER),inputProps:{"data-test":"require-new-password-password-input"}}],this.loading=!1,this.requiredAttributes={},this.newFormFields=this.formFields,this.phoneNumber={countryDialCodeValue:f,phoneNumberValue:" "}}userHandler(){this.setCurrentUser()}handleRequiredAttributeInputChange(t,e){"phone_number"===t?this.formatPhoneNumber(e):this.requiredAttributes[t]=e.target.value}async setCurrentUser(){if(this.user)this.currentUser=this.user;else try{const t=await d.currentAuthenticatedUser();t&&(this.currentUser=t)}catch(t){w(t)}if(this.currentUser&&this.currentUser.challengeParam&&this.currentUser.challengeParam.requiredAttributes){const t=this.currentUser.challengeParam.requiredAttributes,e=x();t.forEach(t=>{this.newFormFields=[...this.newFormFields,{type:t,required:!0,label:e[t].label,placeholder:e[t].placeholder,handleInputChange:e=>this.handleRequiredAttributeInputChange(t,e),inputProps:{"data-test":`require-new-password-${t}-input`}}]})}}componentWillLoad(){return this.setCurrentUser()}handlePasswordChange(t){this.password=t.target.value}formatPhoneNumber(t){v(t,this.phoneNumber);try{if(t.target.name===y&&this.phoneNumber.phoneNumberValue){const t=F(this.phoneNumber);this.requiredAttributes.phone_number=t}}catch(e){E.error("error in phone number field - "+e)}}async completeNewPassword(t){if(t&&t.preventDefault(),!d||"function"!=typeof d.completeNewPassword)throw new Error(m);this.loading=!0;try{const t=await d.completeNewPassword(this.currentUser,this.password,this.requiredAttributes);switch(E.debug("complete new password",t),t.challengeName){case h.SMSMFA:this.handleAuthStateChange(l.ConfirmSignIn,t);break;case h.MFASetup:E.debug("TOTP setup",t.challengeParam),this.handleAuthStateChange(l.TOTPSetup,t);break;default:await k(t,this.handleAuthStateChange)}}catch(e){w(e)}finally{this.loading=!1}}render(){return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),handleSubmit:this.handleSubmit,loading:this.loading,secondaryFooterContent:e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignIn)},s.get(c.BACK_TO_SIGN_IN)),submitButtonText:s.get(this.submitButtonText)},e("amplify-auth-fields",{formFields:this.newFormFields})))}static get watchers(){return{user:["userHandler"]}}},S=class{constructor(e){t(this,e),this.handleSubmit=t=>this.signIn(t),this.headerText=c.SIGN_IN_HEADER_TEXT,this.submitButtonText=c.SIGN_IN_ACTION,this.handleAuthStateChange=b,this.usernameAlias="username",this.formFields=[],this.hideSignUp=!1,this.newFormFields=[],this.loading=!1,this.phoneNumber={countryDialCodeValue:f,phoneNumberValue:null},this.signInAttributes={userInput:"",password:""}}componentWillLoad(){g(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}handleFormFieldInputChange(t){switch(t){case"username":case"email":return t=>this.signInAttributes.userInput=t.target.value;case"phone_number":return t=>v(t,this.phoneNumber);case"password":return t=>this.signInAttributes.password=t.target.value;default:return()=>{}}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(t,e)=>{e(t)})(t,this.handleFormFieldInputChange(e.type).bind(this))}async signIn(t){switch(t&&t.preventDefault(),this.loading=!0,this.usernameAlias){case"phone_number":try{this.signInAttributes.userInput=F(this.phoneNumber)}catch(i){w(i)}}const e=this.signInAttributes.userInput.trim();await _(e,this.signInAttributes.password,this.handleAuthStateChange,this.usernameAlias),this.loading=!1}buildDefaultFormFields(){const t=[];switch(this.usernameAlias){case"email":t.push({type:"email",required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-in-email-input",autocomplete:"username"}});break;case"phone_number":t.push({type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-in-phone-number-input",autocomplete:"username"}});break;case"username":default:t.push({type:"username",required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-in-username-input",autocomplete:"username"}})}t.push({type:"password",hint:e("div",null,s.get(c.FORGOT_PASSWORD_TEXT)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.ForgotPassword),"data-test":"sign-in-forgot-password-link"},s.get(c.RESET_PASSWORD_TEXT))),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-in-password-input"}}),this.newFormFields=[...t]}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(i=>{const n=Object.assign({},i);"password"===n.type&&(n.hint=C(n)?e("div",null,s.get(c.FORGOT_PASSWORD_TEXT)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.ForgotPassword),"data-test":"sign-in-forgot-password-link"},s.get(c.RESET_PASSWORD_TEXT))):n.hint),n.handleInputChange=t=>this.handleFormFieldInputWithCallback(t,i),this.setFieldValue(n,this.signInAttributes),t.push(n)}),this.newFormFields=t}}setFieldValue(t,e){switch(t.type){case"username":case"email":e.userInput=void 0===t.value?"":t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;case"password":e.password=void 0===t.value?"":t.value}}render(){return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-in"},e("div",{slot:"subtitle"},e("slot",{name:"header-subtitle"})),e("slot",{name:"federated-buttons"},e("amplify-federated-buttons",{handleAuthStateChange:this.handleAuthStateChange,federated:this.federated})),!r(this.federated)&&e("amplify-strike",null,"or"),e("amplify-auth-fields",{formFields:this.newFormFields}),e("div",{slot:"amplify-form-section-footer",class:"sign-in-form-footer"},e("slot",{name:"footer"},!this.hideSignUp&&e("slot",{name:"secondary-footer-content"},e("span",null,s.get(c.NO_ACCOUNT_TEXT)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignUp),"data-test":"sign-in-create-account-link"},s.get(c.CREATE_ACCOUNT_TEXT)))),e("div",{class:this.hideSignUp?"full-width-footer-content":""},e("slot",{name:"primary-footer-content"},e("amplify-button",{type:"submit",disabled:this.loading,"data-test":"sign-in-sign-in-button"},this.loading?e("amplify-loading-spinner",null):e("span",null,s.get(this.submitButtonText)))))))))}static get watchers(){return{formFields:["formFieldsHandler"]}}};S.style=":host{--footer-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--footer-font-family:var(--amplify-font-family);--font-weight:var(--amplify-font-weight)}.sign-in-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-in-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-in-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-in-form-footer amplify-button{margin-bottom:0}}.sign-in-form-footer *+*{margin-bottom:15px}.full-width-footer-content{width:100%}";const V=class{constructor(e){t(this,e),this.handleSubmit=t=>this.signUp(t),this.handleSignUp=t=>this.authSignUp(t),this.headerText=c.SIGN_UP_HEADER_TEXT,this.submitButtonText=c.SIGN_UP_SUBMIT_BUTTON_TEXT,this.haveAccountText=c.SIGN_UP_HAVE_ACCOUNT_TEXT,this.signInText=c.SIGN_IN_TEXT,this.formFields=[],this.handleAuthStateChange=b,this.usernameAlias="username",this.newFormFields=[],this.phoneNumber={countryDialCodeValue:f,phoneNumberValue:null},this.loading=!1,this.signUpAttributes={username:"",password:"",attributes:{}}}handleFormFieldInputChange(t){switch(t){case"username":return t=>this.signUpAttributes.username=t.target.value;case"password":return t=>this.signUpAttributes.password=t.target.value;case"email":return t=>this.signUpAttributes.attributes.email=t.target.value;case"phone_number":return t=>v(t,this.phoneNumber);default:return e=>this.signUpAttributes.attributes[t]=e.target.value}}handleFormFieldInputWithCallback(t,e){(e.handleInputChange?e.handleInputChange:(t,e)=>{e(t)})(t,this.handleFormFieldInputChange(e.type).bind(this))}async authSignUp(t){const e=await d.signUp(t);if(!e)throw new Error(c.SIGN_UP_FAILED);return e}assignPhoneNumberToSignUpAttributes(){if(this.phoneNumber.phoneNumberValue)try{this.signUpAttributes.attributes.phone_number=F(this.phoneNumber)}catch(t){w(t)}}assignUserNameAliasToSignUpAttributes(){switch(this.usernameAlias){case"email":case"phone_number":this.signUpAttributes.username=this.signUpAttributes.attributes[this.usernameAlias]}}assignFormInputToSignUpAttributes(){this.assignPhoneNumberToSignUpAttributes(),this.assignUserNameAliasToSignUpAttributes()}validateSignUpAttributes(){if(!this.signUpAttributes.username)throw this.usernameAlias===p.email?new Error(c.EMPTY_EMAIL):this.usernameAlias===p.phone_number?new Error(c.EMPTY_PHONE):new Error(c.EMPTY_USERNAME);if(this.signUpAttributes.username.indexOf(" ")>=0)throw new Error(c.USERNAME_REMOVE_WHITESPACE);if(this.signUpAttributes.password!==this.signUpAttributes.password.trim())throw new Error(c.PASSWORD_REMOVE_WHITESPACE)}async signUp(t){if(t&&t.preventDefault(),!d||"function"!=typeof d.signUp)throw new Error(m);this.loading=!0,this.assignFormInputToSignUpAttributes();try{this.validateSignUpAttributes();const t=await this.handleSignUp(this.signUpAttributes);if(t.userConfirmed)await _(this.signUpAttributes.username,this.signUpAttributes.password,this.handleAuthStateChange);else{const e=Object.assign({},this.signUpAttributes);this.handleAuthStateChange(l.ConfirmSignUp,Object.assign(Object.assign({},t.user),{signUpAttrs:e}))}}catch(e){w(e)}finally{this.loading=!1}}buildDefaultFormFields(){switch(this.usernameAlias){case"email":this.newFormFields=[{type:"email",placeholder:s.get(c.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"username"}},{type:"password",placeholder:s.get(c.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"tel-national"}}];break;case"phone_number":this.newFormFields=[{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input",autocomplete:"username"}},{type:"password",placeholder:s.get(c.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:s.get(c.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input",autocomplete:"email"}}];break;case"username":default:this.newFormFields=[{type:"username",placeholder:s.get(c.SIGN_UP_USERNAME_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("username"),inputProps:{"data-test":"sign-up-username-input",autocomplete:"username"}},{type:"password",placeholder:s.get(c.SIGN_UP_PASSWORD_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("password"),inputProps:{"data-test":"sign-up-password-input",autocomplete:"new-password"}},{type:"email",placeholder:s.get(c.SIGN_UP_EMAIL_PLACEHOLDER),required:!0,handleInputChange:this.handleFormFieldInputChange("email"),inputProps:{"data-test":"sign-up-email-input"}},{type:"phone_number",required:!0,handleInputChange:this.handleFormFieldInputChange("phone_number"),inputProps:{"data-test":"sign-up-phone-number-input"}}]}}buildFormFields(){if(0===this.formFields.length)this.buildDefaultFormFields();else{const t=[];this.formFields.forEach(e=>{const i=Object.assign({},e);i.handleInputChange=t=>this.handleFormFieldInputWithCallback(t,e),this.setFieldValue(e,this.signUpAttributes),t.push(i)}),this.newFormFields=t}}setFieldValue(t,e){switch(t.type){case"username":e.username=void 0===t.value?"":t.value;break;case"password":e.password=void 0===t.value?"":t.value;break;case"email":e.attributes.email=t.value;break;case"phone_number":t.dialCode&&(this.phoneNumber.countryDialCodeValue=t.dialCode),this.phoneNumber.phoneNumberValue=t.value;break;default:e.attributes[t.type]=t.value}}componentWillLoad(){g(this.usernameAlias),this.buildFormFields()}formFieldsHandler(){this.buildFormFields()}render(){return e(i,null,e("amplify-form-section",{headerText:s.get(this.headerText),handleSubmit:this.handleSubmit,testDataPrefix:"sign-up"},e("div",{slot:"subtitle"},e("slot",{name:"header-subtitle"})),e("amplify-auth-fields",{formFields:this.newFormFields}),e("div",{class:"sign-up-form-footer",slot:"amplify-form-section-footer"},e("slot",{name:"footer"},e("slot",{name:"secondary-footer-content"},e("span",null,s.get(this.haveAccountText)," ",e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignIn),"data-test":"sign-up-sign-in-link"},s.get(this.signInText)))),e("slot",{name:"primary-footer-content"},e("amplify-button",{type:"submit","data-test":"sign-up-create-account-button",disabled:this.loading},this.loading?e("amplify-loading-spinner",null):e("span",null,s.get(this.submitButtonText))))))))}static get watchers(){return{formFields:["formFieldsHandler"]}}};V.style="amplify-sign-up{--footer-font-family:var(--amplify-font-family);--footer-font-size:var(--amplify-text-sm);--footer-color:var(--amplify-grey);--font-weight:var(--amplify-font-weight)}.sign-up-form-footer{font-family:var(--footer-font-family);font-size:var(--footer-font-size);color:var(--footer-color);font-weight:--font-weight;display:-ms-flexbox;display:flex;-ms-flex-direction:column-reverse;flex-direction:column-reverse;-ms-flex-align:center;align-items:center;-ms-flex-pack:distribute;justify-content:space-around}.sign-up-form-footer amplify-button{margin-bottom:0.625rem}@media (min-width: 672px){.sign-up-form-footer{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:baseline;align-items:baseline}.sign-up-form-footer amplify-button{margin-bottom:0}}.sign-up-form-footer *+*{margin-bottom:15px}";const H=new n("AmplifyVerifyContact"),N=class{constructor(e){t(this,e),this.handleAuthStateChange=b,this.loading=!1}handleSubmit(t){t.preventDefault(),this.verifyAttr?this.submit(this.code):this.verify(this.contact)}async submit(t){const e=this.verifyAttr;if(!d||"function"!=typeof d.verifyCurrentUserAttributeSubmit)throw new Error(m);this.loading=!0;try{const i=await d.verifyCurrentUserAttributeSubmit(e,t);H.debug(i),this.handleAuthStateChange(l.SignedIn,this.user),this.verifyAttr=null}catch(i){w(i),H.error(i)}finally{this.loading=!1}}async verify(t){if(t){if(!d||"function"!=typeof d.verifyCurrentUserAttribute)throw new Error(m);this.loading=!0;try{const e=await d.verifyCurrentUserAttribute(t);H.debug(e),this.verifyAttr=t}catch(e){w(e),H.error(e)}finally{this.loading=!1}}else H.error("Neither Email nor Phone Number selected")}handleInputChange(t){const e=t.target.name;"code"===e?this.code=t.target.value:"contact"===e&&(this.contact=t.target.value)}renderSubmit(){return e("div",null,e("amplify-input",{inputProps:{autocomplete:"off","data-test":"verify-contact-code-input"},name:"code",placeholder:s.get(c.CODE_PLACEHOLDER),handleInputChange:t=>this.handleInputChange(t)}))}renderVerify(){const t=this.user;if(!t)return H.debug("No user to verify"),null;const{unverified:i}=t;if(!i)return H.debug("Unverified variable does not exist on user"),null;const{email:n,phone_number:a}=i;return e("div",null,n&&e("amplify-radio-button",{label:s.get(c.VERIFY_CONTACT_EMAIL_LABEL),key:"email",name:"contact",value:"email",handleInputChange:t=>this.handleInputChange(t),inputProps:{"data-test":"verify-contact-email-radio"}}),a&&e("amplify-radio-button",{label:s.get(c.VERIFY_CONTACT_PHONE_LABEL),key:"phone_number",name:"contact",value:"phone_number",handleInputChange:t=>this.handleInputChange(t),inputProps:{"data-test":"verify-contact-phone-number-radio"}}))}render(){return e(i,null,e("amplify-form-section",{handleSubmit:t=>this.handleSubmit(t),headerText:s.get(c.VERIFY_CONTACT_HEADER_TEXT),loading:this.loading,secondaryFooterContent:e("span",null,e("amplify-button",{variant:"anchor",onClick:()=>this.handleAuthStateChange(l.SignedIn,this.user),"data-test":"verify-contact-skip-link"},"Skip")),submitButtonText:s.get(this.verifyAttr?c.VERIFY_CONTACT_SUBMIT_LABEL:c.VERIFY_CONTACT_VERIFY_LABEL)},this.verifyAttr?this.renderSubmit():this.renderVerify()))}};export{I as amplify_confirm_sign_in,P as amplify_confirm_sign_up,j as amplify_forgot_password,T as amplify_require_new_password,S as amplify_sign_in,V as amplify_sign_up,N as amplify_verify_contact}